<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>t</title>
		<style>
			.a{
				width: 500px;
				margin:auto;
			}
			.canvas{
				width: 500px;
				height: 300px;
				background-color: #F0F0F0;
			}
		</style>
		<script>
			window.onload = function() {
				let canvas = document.getElementById("content");
				canvas.width = canvas.offsetWidth;
				canvas.height = canvas.offsetHeight;
				let ctx = canvas.getContext("2d");//контекст рисования на холсте
	  			
	  			let area = {x:150,y:150,r:100};//область, за пределы которой не должен выходить круг
	  			let ball = {x:150,y:150,r:10};//круг
	  			PrintArea();
	  			PrintBall();

	  			let areaCoordinates = AreaCoordinates();
	  			let restrict = Restriction();
	  			let mouseX, mouseY;

				canvas.onmousemove = function(e) {
					let canvasCoordinates = this.getBoundingClientRect();//объект координат элемента-canvas
					//console.log(canvasCoordinates);
					mouseX = e.clientX - canvasCoordinates.left;//координаты мыши 
      				mouseY = e.clientY - canvasCoordinates.top;//относительно canvas'a

					ctx.clearRect(0, 0, canvas.width, canvas.height);//очистить прямоугольник размерами canvas'a
					PrintArea();

					MoveBall();
				};

				function PrintArea(){
					ctx.beginPath();//сброс текущиго контура
					ctx.strokeStyle = '#34648E';
					ctx.stroke();//линия

					let x1 = area.x-area.r,
					y1 = area.y-area.r,
					x2 = area.r*2,
					y2 = area.r*2;
					ctx.strokeRect(x1,y1,x2,y2);
				}
				function PrintBall(x=ball.x,y=ball.y){
					ctx.beginPath();
					ctx.arc(x, y, ball.r, 0, 2*Math.PI, false);
					ctx.fillStyle = '#0294BF';
					ctx.fill();//заливка
				}

				function AreaCoordinates(){
					let x1 = area.x - area.r,
					x2 = area.x + area.r,
					y1 = area.y - area.r,
					y2 = area.y + area.r;
					return {x1:x1,x2:x2,y1:y1,y2:y2}
				}
				//до каких точек круг может двигаться
				//координаты area +- размер круга
				function Restriction(){
					return {
						x1:areaCoordinates.x1+ball.r,
						x2:areaCoordinates.x2-ball.r,
						y1:areaCoordinates.y1+ball.r,
						y2:areaCoordinates.y2-ball.r
					}
				}

				//вычислить координаты круга и переместить его в эту точку
				function MoveBall(){
					let x=mouseX,
					y=mouseY;
					if(mouseX<restrict.x1)
						x=restrict.x1;
					if(mouseX>restrict.x2)
						x=restrict.x2;
					if(mouseY<restrict.y1)
						y=restrict.y1;
					if(mouseY>restrict.y2)
						y=restrict.y2;

					PrintBall(x,y);
				}

  			}
		</script>
	</head>
	<body>
		<div class='a'>
			<canvas class='canvas' id='content'></canvas>
		</div>
	</body>
</html>		
